# React 勘测笔记 I - 导论，从 App 的入口开始

:black_nib: React 版本: 16.8.6

:beers: 参考 [cyk 的剖析 React 源码博客系列](https://juejin.im/post/5cbae9a8e51d456e2809fba3)，我尝试同样使用“文章+源码注释工程”的方式，并在文章中添加合适的跳转标记跳转到代码部分。我的 fork 见[这里](https://github.com/TAUnionOtto/react-interpretation)。

:dolphin: 注释工程的跳转标签会以 :dolphin: 为开头。

首先我们考虑如下的代码：

```js
import React from 'react';
import ReactDOM from 'react-dom';

class SourceProbe extends React.Component {
  render() {
    return <div id="root">Rua!</div>
  }
}

const SourceProbeElemet = React.createElement(SourceProbe)
const rootContainer = document.getElementById('app');
ReactDOM.render(SourceProbeElemet, rootContainer);
```

- :black_nib: 了解 JSX 的同学应该明白 

  ```js
  React.createElement(SourceProbe)  
  React.createElement('div', { id: 'root', 'Rua!' })
  ```

  相当于

  ```jsx
  <SourceProbe />
  <div id="root">Rua!</div>
  ```

- :black_nib: 考察 SourceProbe 的原型链，我们可以发现

  ```js
  SourceProbe ----> React.Component --> Function.prototype
  ```

  故 `React.Component` 的父类直接指向 `Function`，React 应该没有再做其他工作了。

## [`React.Component`](https://zh-hans.reactjs.org/docs/react-component.html)

- :watermelon: 浏览 `React.Component` 的文档，最引我瞩目的是 React 的这一申明：

  > 我们强烈建议你不要创建自己的组件基类。 在 React 组件中，[代码重用的主要方式是组合而不是继承](https://zh-hans.reactjs.org/docs/composition-vs-inheritance.html)。

  事实上我也在工作中尝试过使用基类组件和继承做一些组件的业务，结果是*灾难性的*难以维护、增强和重构。在这里也许没有人能在数学上给出“React 的组合能完全替代继承”的证明，但就经验上来说，我同意 React 的以上观点。

  但同时，React 的开发中也是有很多优秀的模式的，他们通常基于“组合”和“单向数据流”，我会在后面的文章中收集一些优秀的模式作为介绍。

:dolphin: 我们看 [ReactBaseClasses.js](https://github.com/TAUnionOtto/react-interpretation/blob/master/packages/react/src/ReactBaseClasses.js)，里面阐述了 `Component` 和 `PureComponent` 的相关结构和方法。

可以看到 `Component` 内没有任何具体的实现，`refs` 和 `updater` 均为未来的处理留下了触点。挂载了两个重要的方法，`setState` 和 `forceUpdate`，这两个方法都需要未来对 `updater` 赋真实值后才会有具体的作用；以及一个标识 `isReactComponent`。

`PureComponent` 的有关代码只是实现了 `PureComponent` 对 `Component` 的继承，以及一个标识 `isPureReactComponent`。`isPureReactComponent` 会在执行 `shouldComponentUpdate` 回调时区分两种组件， 使得 `PureComponent` 特别的只对 props 与 state 进行浅比较。

## [`React.createElement`](https://zh-hans.reactjs.org/docs/react-api.html#createelement)

考察 `React.createElement` 的参数，


